<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Jadwal Sholat Tasikmalaya</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600;800&display=swap');

  :root {
    --color-primary: #0f4c81;
    --color-secondary: #357ABD;
    --color-bg: #ffffff;
    --color-text: #374151;
    --color-muted: #6b7280;
    --color-card-bg: rgba(255 255 255 / 0.95);
    --border-radius: 0.75rem;
    --transition-speed: 0.3s;
    --input-border: #cbd5e1;
    --input-focus-border: var(--color-primary);
    --shadow-light: rgba(15, 76, 129, 0.12);
    --font-base-size: 17px;
  }

  /* Reset dan base */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background-color: var(--color-bg);
    color: var(--color-text);
    font-size: var(--font-base-size);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    user-select: none;
    
    /* Background islami dengan pola SVG dan gradient halus */
    background-image: 
      linear-gradient(135deg, #e0e7ff 15%, #f5f7ff 85%),
      url('data:image/svg+xml;utf8,%3csvg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"%3e%3cpath d="M20 0L25.88 14H38.32L27.22 22.68L33.1 36.68L20 28L6.9 36.68L12.78 22.68L1.68 14H14.12L20 0Z" fill="%230f4c81" fill-opacity="0.05"/%3e%3c/svg%3e');
    background-repeat: repeat;
    background-attachment: fixed;
    background-size: auto;
  }

  /* Container max width */
  .container {
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    padding-left: 1.25rem;
    padding-right: 1.25rem;
  }

  /* Header sticky dengan blur dan bayangan */
  header {
    position: sticky;
    top: 0;
    background: rgba(255 255 255 / 0.85);
    backdrop-filter: saturate(180%) blur(10px);
    border-bottom: 1px solid #e5e7eb;
    padding: 1.25rem 0;
    z-index: 99;
    user-select: none;
    box-shadow: 0 2px 6px rgba(0 0 0 / 0.05);
  }
  .header-content {
    max-width: 600px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-left: 1rem;
    padding-right: 1rem;
  }
  .logo {
    font-weight: 800;
    font-size: 1.5rem;
    color: var(--color-primary);
  }
  .wib-clock {
    font-weight: 600;
    font-size: 1.25rem;
    color: var(--color-secondary);
    font-variant-numeric: tabular-nums;
    user-select: text;
  }
  nav {
    display: none;
  }

  /* Hero section */
  .hero {
    padding-top: 3rem;
    padding-bottom: 3rem;
    text-align: center;
  }
  .hero h1 {
    font-size: 2.75rem;
    font-weight: 800;
    color: var(--color-primary);
    line-height: 1.1;
    margin: 0;
    user-select: text;
  }
  .hero p {
    margin-top: 0.7rem;
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--color-muted);
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
    user-select: text;
  }
  .btn-refresh {
    margin-top: 1.8rem;
    background-color: var(--color-primary);
    color: white;
    font-weight: 700;
    padding: 0.75rem 2.5rem;
    border: none;
    border-radius: var(--border-radius);
    font-size: 1.125rem;
    cursor: pointer;
    transition: background-color var(--transition-speed), transform var(--transition-speed);
    box-shadow: 0 8px 24px var(--shadow-light);
    user-select: none;
  }
  .btn-refresh:hover,
  .btn-refresh:focus {
    background-color: var(--color-secondary);
    outline: none;
    transform: scale(1.05);
  }

  /* Date picker */
  .date-picker {
    background: var(--color-card-bg);
    border-radius: var(--border-radius);
    box-shadow: 0 12px 24px var(--shadow-light);
    padding: 1.5rem 1.75rem;
    max-width: 300px;
    margin: 0 auto 3rem auto;
    user-select: none;
  }
  .date-picker label {
    font-weight: 600;
    color: var(--color-primary);
    font-size: 1rem;
    display: block;
    margin-bottom: 0.45rem;
    user-select: text;
  }
  input[type=date] {
    width: 100%;
    padding: 0.55rem 1rem;
    font-size: 1.125rem;
    border: 1.8px solid var(--input-border);
    border-radius: 0.5rem;
    background: white;
    color: var(--color-text);
    transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
  }
  input[type=date]:hover {
    border-color: var(--color-primary);
  }
  input[type=date]:focus {
    outline: none;
    border-color: var(--input-focus-border);
    box-shadow: 0 0 6px var(--input-focus-border);
  }

  /* Prayer info content */
  .prayer-info {
    background: var(--color-card-bg);
    border-radius: var(--border-radius);
    padding: 3rem 2rem;
    box-shadow: 0 12px 36px var(--shadow-light);
    user-select: none;
  }
  .date-display {
    font-weight: 600;
    color: var(--color-primary);
    font-size: 1.5rem;
    text-align: center;
    margin-bottom: 2.25rem;
    user-select: text;
  }

  /* Seksi grid untuk box melebar */
  .prayers-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 1.5rem;
  }

  /* Kartu waktu sholat */
  .prayer-card {
    background: #fff;
    border-radius: var(--border-radius);
    padding: 1rem 0;
    box-shadow: 0 10px 30px rgba(15, 76, 129, 0.08);
    cursor: default;
    text-align: center;
    display: flex;
    flex-direction: column;
    user-select: text;
    transition: transform var(--transition-speed), box-shadow var(--transition-speed);
  }
  .prayer-card:hover,
  .prayer-card:focus-within {
    transform: scale(1.06);
    box-shadow: 0 15px 45px rgba(15, 76, 129, 0.18);
  }

  /* Bagian nama waktu (header kecil dalam kartu) */
  .prayer-name {
    background: var(--color-primary);
    color: white;
    font-size: 1.1rem;
    font-weight: 700;
    padding: 0.5rem 0;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    user-select: none;
  }

  /* Waktu sholat besar di bawah */
  .prayer-time {
    flex-grow: 1;
    font-size: 2rem;
    font-weight: 900;
    color: var(--color-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem 0;
  }

  /* Footer */
  footer {
    margin-top: 4rem;
    padding-bottom: 3rem;
    font-size: 1rem;
    color: var(--color-muted);
    text-align: center;
    user-select: none;
  }

  /* Responsive: untuk layar kecil gunakan 2 kolom */
  @media (max-width: 480px) {
    html {
      font-size: 16px;
    }
    .container {
      max-width: 100%;
      padding-left: 1rem;
      padding-right: 1rem;
    }
    .date-picker {
      max-width: 100%;
      padding: 1rem 1rem;
      margin-bottom: 2rem;
    }
    .hero h1 {
      font-size: 2.25rem;
      line-height: 1.15;
    }
    .hero p {
      font-size: 1.125rem;
    }
    .btn-refresh {
      width: 100%;
      font-size: 1.25rem;
      padding: 1rem 0;
    }
    .prayers-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }
    .prayer-card {
      padding: 1rem 0;
    }
    .prayer-name {
      font-size: 1rem;
    }
    .prayer-time {
      font-size: 1.6rem;
    }
  }
</style>
</head>
<body>
  <header role="banner" aria-label="Navigasi utama aplikasi">
    <div class="header-content container">
      <div class="logo" aria-label="Logo aplikasi Jadwal Sholat Tasikmalaya">
        Tasikmalaya Sholat
      </div>
      <div class="wib-clock" aria-live="polite" aria-atomic="true" aria-label="Jam waktu Indonesia Barat">
        WIB: <span id="wib-clock-time" aria-live="off">--:--</span>
      </div>
    </div>
  </header>

  <main class="container" role="main" aria-label="Aplikasi Jadwal Sholat Tasikmalaya">
    <section class="hero" aria-label="Bagian utama aplikasi">
      <h1 tabindex="0">Jadwal Sholat Tasikmalaya</h1>
      <p tabindex="0">Pilih tanggal untuk melihat waktu sholat dengan akurat dan lengkap.</p>
      <button id="btn-refresh" class="btn-refresh" aria-label="Segarkan jadwal sholat hari ini">Segarkan Jadwal Hari Ini</button>
    </section>

    <section class="date-picker" aria-label="Form pilihan tanggal jadwal sholat">
      <label for="date-select">Pilih Tanggal</label>
      <input type="date" id="date-select" aria-required="true" value="" />
    </section>

    <section class="prayer-info" aria-live="polite" aria-atomic="true" aria-relevant="additions" tabindex="0">
      <div class="date-display" id="date-display" aria-label="Tanggal yang dipilih"></div>
      <div class="prayers-grid" id="prayers-grid" role="list" aria-label="Waktu sholat untuk tanggal yang dipilih">
        <!-- Jadwal sholat akan muncul di sini -->
      </div>
    </section>
  </main>

  <footer>
    &copy; 2025 Jadwal Sholat Tasikmalaya. Semua hak cipta dilindungi. 
  </footer>

<script>
  const prayers = [
    { name: "Subuh", key: "Fajr" },
    { name: "Dzuhur", key: "Dhuhr" },
    { name: "Ashar", key: "Asr" },
    { name: "Maghrib", key: "Maghrib" },
    { name: "Isya", key: "Isha" }
  ];

  const latitude = -7.3183;
  const longitude = 108.2085;

  const dateInput = document.getElementById('date-select');
  const dateDisplay = document.getElementById('date-display');
  const prayersGrid = document.getElementById('prayers-grid');
  const btnRefresh = document.getElementById('btn-refresh');
  const wibClockTime = document.getElementById('wib-clock-time');

  // Set default tanggal input ke hari ini
  function setTodayDate() {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = (today.getMonth() + 1).toString().padStart(2, '0');
    const dd = today.getDate().toString().padStart(2, '0');
    dateInput.value = `${yyyy}-${mm}-${dd}`;
  }

  // Format tanggal ke lokal ID dengan nama hari, tanggal, bulan, tahun
  function formatDateIndo(date) {
    return date.toLocaleDateString('id-ID', {
      weekday:'long', day:'numeric', month:'long', year:'numeric'
    });
  }

  // Ambil jadwal sholat dari API aladhan
  async function fetchPrayerTimes(date) {
    try {
      const timestamp = Math.floor(date.getTime() / 1000);
      const url = `https://api.aladhan.com/v1/timings/${timestamp}?latitude=${latitude}&longitude=${longitude}&method=11`;
      const response = await fetch(url);
      const data = await response.json();
      if(data.code === 200 && data.data && data.data.timings) {
        return data.data.timings;
      }
      throw new Error("Gagal mengambil jadwal sholat");
    } catch(e) {
      console.error(e);
      return {
        Fajr:"04:35", Dhuhr:"12:00", Asr:"15:15", Maghrib:"18:00", Isha:"19:15"
      };
    }
  }

  // Render jadwal sholat ke UI
  async function renderPrayerTimes() {
    const selectedDate = new Date(dateInput.value);
    dateDisplay.textContent = formatDateIndo(selectedDate);

    const timings = await fetchPrayerTimes(selectedDate);

    prayersGrid.innerHTML = '';
    prayers.forEach(({name, key}) => {
      const card = document.createElement('div');
      card.className = 'prayer-card';
      card.setAttribute('role', 'listitem');

      const nameEl = document.createElement('div');
      nameEl.className = 'prayer-name';
      nameEl.textContent = name;

      const timeEl = document.createElement('div');
      timeEl.className = 'prayer-time';
      timeEl.textContent = timings[key] || "-";

      card.appendChild(nameEl);
      card.appendChild(timeEl);
      prayersGrid.appendChild(card);
    });
  }

  // Update jam WIB tanpa detik, per menit
  function updateWibClock() {
    const now = new Date();
    const utc = now.getTime() + now.getTimezoneOffset() * 60000;
    const wibTime = new Date(utc + 7*3600000);
    const h = wibTime.getHours().toString().padStart(2, '0');
    const m = wibTime.getMinutes().toString().padStart(2, '0');
    wibClockTime.textContent = `${h}:${m}`;
  }

  // Setup event listener dan inisialisasi
  function setup() {
    setTodayDate();
    renderPrayerTimes();
    updateWibClock();
    setInterval(() => {
      updateWibClock();
    }, 60000);

    dateInput.addEventListener('change', () => {
      renderPrayerTimes();
    });

    btnRefresh.addEventListener('click', () => {
      setTodayDate();
      renderPrayerTimes();
      btnRefresh.blur();
    });
  }

  setup();
</script>
</body>
</html>